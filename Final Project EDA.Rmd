---
title: "R Notebook"
author: "Vincent Smedile"
date: "15 November, 2020"
output: html_notebook
---

### Front Matter
```{r}
# Load required packages
library(ggplot2)
library(rio)
library(descr)
library(stargazer)
library(dplyr)
```

```{r}
#Load Data Files

covid_data <- read.csv("covid_international.csv")
gni_data <- read.csv("Income ratings.csv")
```

### Preliminary Cleaning of Data

```{r}
covid_data <-
  covid_data %>%
  mutate(death_rate = ((death_rate/population)*1000000))%>%
  mutate(inf_rate = ((inf_rate/population)*1000000))

marxist <-
  covid_data %>%
  filter(iso_code %in% c("CHN","LAO","CUB","VNM"))%>%
  select(location,iso_code,inf_rate,death_rate,deaths,cases,gdp_pc)%>%
  mutate(inf_prev_lev = inf_rate+cases)%>%
  mutate(death_prev_lev = deaths + death_rate)%>%
  mutate(response_sucess_lev = inf_prev_lev+death_prev_lev)%>%
  mutate(state_type = 3)

socialist_govs <-
  covid_data %>%
  filter(location %in% c("Nepal","Venezuela","Spain","New Zealand","Nicaragua","Argenti","Mozambique","Moldova","Angola","Algeria"))%>%
  select(location,iso_code,inf_rate,death_rate,deaths,cases,gdp_pc)%>%
  mutate(inf_prev_lev = inf_rate+cases)%>%
  mutate(death_prev_lev = deaths + death_rate)%>%
  mutate(response_sucess_lev = inf_prev_lev+death_prev_lev)%>%
  mutate(state_type = 2)

nordic_model <- 
  covid_data %>%
  filter(location %in% c("Iceland","Norway","Sweden","Denmark","Finland"))%>%
  select(location,iso_code,inf_rate,death_rate,deaths,cases,gdp_pc)%>%
  mutate(inf_prev_lev = inf_rate+cases)%>%
  mutate(death_prev_lev = deaths + death_rate)%>%
  mutate(response_sucess_lev = inf_prev_lev+death_prev_lev)%>%
  mutate(state_type = 1)

`%notin%` <- Negate(`%in%`) #allows me to not include the selected countries when filtering

capitalist_govs <- 
  covid_data %>%
  filter(location %notin% c("Iceland","Norway","Sweden","Denmark","Finland","Nepal","Venezuela","Spain","New Zealand","Nicaragua","Argenti","Mozambique","Moldova","Angola","Algeria"))%>%
  filter(iso_code %notin% c("CHN","LAO","CUB","VNM"))%>%
  select(location,iso_code,inf_rate,death_rate,deaths,cases,gdp_pc)%>%
  mutate(inf_prev_lev = inf_rate+cases)%>%
  mutate(death_prev_lev = deaths + death_rate)%>%
  mutate(response_sucess_lev = inf_prev_lev+death_prev_lev)%>%
  mutate(state_type = 0)

adapted_covid_data <-
  capitalist_govs %>%
    full_join(marxist)%>%
    full_join(nordic_model)%>%
    full_join(socialist_govs)%>%
    select(location,iso_code,state_type,response_sucess_lev,death_prev_lev,inf_prev_lev,gdp_pc)%>%
  arrange(location)

complete_cov_data <-
  adapted_covid_data %>%
  left_join(gni_data %>% select(Country.Code,IncomeGroup),by=c("iso_code"="Country.Code"))

complete_cov_data %>%
  mutate()
  
```


### Guiding Question (i.e., Research Question): Make a clear statement of a single guiding/research question that will drive your analysis.  It should be phrased as a question that you will try to investigate (i.e., it should have a question mark) 

**Research Question:** Does a state's socioeconomic and political structure (such as socialism, capitalism, the "Nordic Model, or Communism) effect it's ability to deal with the Coronavirus? And what other factors might cause the disparity we see between nations like the United States and nations like Vietnam?

#### - Become acquainted with your data sources

  - Where did you find them?
  
  The Primary source I obatained from Clayton Webb of the Kansas State Unversity Political Science Department (a partner of my Political Science professor here at Penn State), who complied the dataset using datasets from the [Our World in Data](https://ourworldindata.org/) and [The Quality of Government Institute](https://qog.pol.gu.se/). ISO Codes were taken from the [International Organization for Standardization](https://www.iso.org/about-us.html). The secondary source I obtained from the [World Bank](https://data.worldbank.org/indicator/NY.GNP.PCAP.CD).

  
  - Who collected/maintains them?
  
  The Covid International Dataset is collected and maintained by Clayton Webb of KSU and the GNI data is collected and maintained by the World Bank.
  
  - When & Why were they originally collected?
  
  The COVID International Dataset was collected by Professor Webb for the purposes of analyzing the social and political impacts of COVID-19 on international affairs. Due to his past partnerships with Professor Linn of the Penn State Political Science Department, the PSU Polisci Dept. also uses it for the same purposes and gives it to Polisci students for individual research practice. 
  
  - What does a case represent in each data source, and how many total cases are available?
  
  A case in both the GNI and the COVID International Dataset is a single nation-state.
  
  - What are some of the variables that you plan to use?

I plan on specifically using the number of deaths, death rate, infection rate, total number of infected. These will be all summed together to create a COVID Response Sucess Rating (CRSR). Response level, population density, and economic development level will be used as control variables/in case of spurious relations.

### Explore intuition related to the research question 

#### 1. Create some informative plots and summary statistics 

##### Central Tendancy, Range, Standard Dev., Etc. 

```{r}
median(complete_cov_data$response_sucess_lev,na.rm=TRUE)
mean(complete_cov_data$response_sucess_lev,na.rm=TRUE)
range(complete_cov_data$response_sucess_lev,na.rm=TRUE)
sd(complete_cov_data$response_sucess_lev,na.rm=TRUE)
cor(complete_cov_data$state_type,complete_cov_data$response_sucess_lev, use = "pairwise.complete.obs",method = "pearson")
```

```{r}
complete_cov_data %>%
  ggplot(mapping=aes(x=factor(state_type), y=response_sucess_lev,fill=factor(state_type)))+
  geom_boxplot()+
  labs(title="Distribution of COVID Response Rating \nby State Type",
       caption="Source: COVID International Dataset \nWorld Bank",
       fill="State Type",
       x="State Type",
       y="Covid Response Sucess Rating")+
  scale_x_discrete(labels = c("Capitalist", "Nordic Model", "Socialist", "Marxist"))+
  scale_y_continuous(limits = c(0,15000))+
  scale_fill_discrete(labels = c("Capitalist", "Nordic Model", "Socialist", "Marxist"))
```

```{r}
complete_cov_data%>%
  ggplot(mapping=aes(x=response_sucess_lev,facet=factor(state_type),fill=factor(state_type)))+
  geom_density(alpha=.5,aes(color=factor(state_type)))+
  guides(color=FALSE)+
  labs(title="Density Distribution of COVID Response Rating \nby State Type",
       caption="Source: COVID International Dataset \nWorld Bank",
       fill="State Type",
       x="Covid Response Sucess Rating",
       y="Density")+
  scale_x_continuous(limits=c(0,15000))+
  scale_fill_discrete(labels = c("Capitalist", "Nordic Model", "Socialist", "Marxist"))+
  facet_wrap(~state_type)
```


#### 2. Describe preliminary observations and intuition about the research question


